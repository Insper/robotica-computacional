<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
      
        <title>Simulação Drone PID - Robótica Computacional - Insper</title>
      
    
    <link rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Fira+Sans+Extra+Condensed:700|Oxygen+Mono|Source+Sans+Pro:700|Source+Serif+Pro&amp;display=swap">
    <link rel="stylesheet" href="../../../../assets/css/main.css">
    <script>
      // SETUP GLOBAL CONSTANTS
      var base_url = '../../../..';
      
      var telemetryEnabled = false;
      var backendUrl = "";
      var courseSlug = "";
      
      
      var dashboardEnabled = false;
      var tagTree = {};
      

      // SETUP PLUGIN
      window.initialized = false;
      if (!window.initializers) window.initializers = [];
      window.registerInitializer = (initialize) => {
        if (window.initialized) initialize();
        else window.initializers.push(initialize);
      };
    </script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true
        }
      });
    </script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="https://unpkg.com/hyperscript.org"></script>
    <script src="https://unpkg.com/htmx.org@1.8.4"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="../../../../assets/js/main.js"></script>
    
    <link rel="stylesheet" href="../../../../equipe.css"><link rel="stylesheet" href="../../../../css/ansi-colours.css"><link rel="stylesheet" href="../../../../css/jupyter-cells.css"><link rel="stylesheet" href="../../../../css/pandas-dataframe.css">
  </head>
  <body>
    <div class="ah-main-container">
      <header class="ah-header">
        <button class="ah-menu-btn ah-button ah-button--borderless"
                aria-label="toggle menu">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
  <!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
  <path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/>
</svg>
        </button>
        <a href="../../../.."
           title="Robótica Computacional - Insper"
           class="ah-logo"
           aria-label="Robótica Computacional - Insper">
          Robótica Computacional - Insper
        </a>
        <div class="ah-header--right">
          
          
          
          <button id="resetHandoutButton">
            <span class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
  <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"/>
</svg></span>
          </button>
          

          
        </div>
      </header>
      <nav class="ah-navigation preload">
        <div class="ah-nav-container">
          <button class="ah-menu-btn ah-button ah-button--borderless close-menu"
                  aria-label="close menu">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512">
  <!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
  <path d="M310.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L160 210.7 54.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L114.7 256 9.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 301.3 265.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L205.3 256 310.6 150.6z"/>
</svg>
          </button>
          <ul class="ah-nav-body">
            
              
  
    <li>
      <a href="../../../..">Home</a>
    </li>
  

            
              
  
    <li>
      <a href="../../../../criterios/">Critérios de Aprovação</a>
    </li>
  

            
              
  
    <li>
      <a href="../../../../aps/">Sobre as APS</a>
    </li>
  

            
              
  
    <li>
      <a href="../../../../screen_record/">Como Gravar a Tela no Linux</a>
    </li>
  

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Unidade 1</span>
    <ul>
      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Capítulo 1 - Introdução ao Curso</span>
    <ul>
      
        
  
    <li>
      <a href="../../../01-intro/">Index</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../01-intro/atividades/atividade-dia1/">Atividade Dia 1</a>
    </li>
  

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Atividades</span>
    <ul>
      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">1 - Infra</span>
    <ul>
      
        
  
    <li>
      <a href="../../../01-intro/atividades/guias-infra/">Começe Aqui!</a>
    </li>
  

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">1.1 - Linux</span>
    <ul>
      
        
  
    <li>
      <a href="../../../01-intro/atividades/guias-infra/ssd-linux/">Início</a>
    </li>
  

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Primeiro boot com SSD</span>
    <ul>
      
        
  
    <li>
      <a href="../../../01-intro/atividades/guias-infra/ssd-linux/recebi-meu-ssd/">Primeiro Boot</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../01-intro/atividades/guias-infra/ssd-linux/recebi-meu-ssd/windows/">Primeiro Boot - Windows</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../01-intro/atividades/guias-infra/ssd-linux/recebi-meu-ssd/mac-os/">Primeiro Boot - MAC</a>
    </li>
  

      
    </ul>
  </li>

      
        
  
    <li>
      <a href="../../../01-intro/atividades/guias-infra/ssd-linux/primeiros-passos/">Meu SSD subiu, e agora?</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../01-intro/atividades/guias-infra/ssd-linux/guia-linux/">Guia básico de Linux</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../01-intro/atividades/guias-infra/ssd-linux/git-e-github/">Configure o seu Git</a>
    </li>
  

      
    </ul>
  </li>

      
        
  
    <li>
      <a href="../../../01-intro/atividades/guias-infra/robo-simulado/">1.2 - Robô Simulado</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../01-intro/atividades/guias-infra/turtlebot3/">1.3 - Robô TurtleBot3</a>
    </li>
  

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">2 - Revisão Python</span>
    <ul>
      
        
  
    <li>
      <a href="../../../01-intro/atividades/21-classes/">2.1 - Introdução à Classes no Python</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../01-intro/atividades/22-funcoes/">2.2 - Dicionario e Funções</a>
    </li>
  

      
    </ul>
  </li>

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">APS 1</span>
    <ul>
      
        
  
    <li>
      <a href="https://classroom.github.com/a/C_JjJjs8">APS 1 - Classroom</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../01-intro/aps/enunciado/">Enunciado</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../01-intro/atividades/guias-infra/checagem/">Checagem da Infra</a>
    </li>
  

      
    </ul>
  </li>

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Capítulo 2 - Introdução à ROS 2</span>
    <ul>
      
        
  
    <li>
      <a href="../../../02-intro-ros/">Index</a>
    </li>
  

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Atividades</span>
    <ul>
      
        
  
    <li>
      <a href="../../../02-intro-ros/atividades/1-package/">1 - Pacotes e Comandos</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../02-intro-ros/atividades/2-topicos/">2 - Topicos na ROS</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../02-intro-ros/atividades/3-creating-package/">3 - Criando um Pacote</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../02-intro-ros/atividades/4-pub-sub/">4 - Publisher e Subscriber na ROS</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../02-intro-ros/atividades/5-rosbag/">5 - Salvando Eventos na ROS</a>
    </li>
  

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">APS 2</span>
    <ul>
      
        
  
    <li>
      <a href="https://classroom.github.com/a/qdcKXPHO">APS 2 - Classroom</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../02-intro-ros/aps/enunciado/">Enunciado</a>
    </li>
  

      
    </ul>
  </li>

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Capítulo 3 - Controlando o Robô</span>
    <ul>
      
        
  
    <li>
      <a href="../../../03-laser-e-robo/">Index</a>
    </li>
  

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Atividades</span>
    <ul>
      
        
  
    <li>
      <a href="../../../03-laser-e-robo/atividades/1-maquina-de-estados/">1 - Máquina de Estados</a>
    </li>
  

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">2 - Estrutura Básica de um Nó</span>
    <ul>
      
        
  
    <li>
      <a href="../../../03-laser-e-robo/atividades/2-estrutura-basica/">2 - Estrutura Básica de um Nó</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../03-laser-e-robo/util/base.py">Download > Nó Básico</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../03-laser-e-robo/util/base_action.py">Download > Nó Base de Ação</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../03-laser-e-robo/util/base_control.py">Download > Nó Cliente da Ação</a>
    </li>
  

      
    </ul>
  </li>

      
        
  
    <li>
      <a href="../../../03-laser-e-robo/atividades/3-odometria/">3 - Entendendo a Odometria</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../03-laser-e-robo/atividades/4-laser/">4 - Entendendo o Laser</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../03-laser-e-robo/atividades/5-acao-andar/">5 - Ação de Andar</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../03-laser-e-robo/atividades/6-visualizacao/">6 - Visualização na ROS</a>
    </li>
  

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">APS 3</span>
    <ul>
      
        
  
    <li>
      <a href="https://classroom.github.com/a/gw4IPvW-">APS 3 - Classroom</a>
    </li>
  

      
        
  
    <li>
      <a href="../../../03-laser-e-robo/aps/enunciado/">Enunciado</a>
    </li>
  

      
    </ul>
  </li>

      
    </ul>
  </li>

      
    </ul>
  </li>

            
          </ul>
        </div>
      </nav>
      <main class="ah-content ah-typeset">
        
          <div class="ah-title-box">
            <ul class="ah-breadcrumbs">
              
                
                <li>Simulação Drone PID</li>
            </ul>
            <h1>Simulação Drone PID</h1>
            
          </div>
          
            <section class="progress-section show">
<h1 id="introducao-ao-controle">Introdução ao Controle</h1>
<p>O controle é uma disciplina fundamental da engenharia que lida com a gestão dinâmica dos sistemas para que eles se comportem de maneira desejada. A essência do controle está em monitorar e ajustar automaticamente a operação de sistemas, desde simples dispositivos mecânicos até complexas redes de comunicação e sistemas robóticos.</p>
<p>O princípio básico é regular as variáveis de um sistema mantendo-as próximas a um valor desejado ou setpoint. Isso é feita através do calculo do erro entre o valor desejado e o valor medido da variável controlada, e então aplicando ações corretivas para minimizar esse erro.</p>
<h2 id="tipos-de-controle">Tipos de Controle</h2>
<p>Existem dois tipos principais de controle: o controle em malha aberta e o controle em malha fechada:</p>
<ol>
<li>
<p>Controle em Malha Aberta: Não há feedback do processo. As ações de controle são baseadas em um conjunto pré-definido de instruções que não se alteram em resposta ao estado atual do sistema. Um exemplo simples seria um forno elétrico programado para ficar ligado por um tempo determinado, independentemente da temperatura real dentro do forno.</p>
</li>
<li>
<p>Controle em Malha Fechada (ou Controle com Feedback): Usa o feedback do estado atual do sistema para tomar decisões de controle. Este tipo de controle é mais adaptativo e pode corrigir desvios em relação ao setpoint. Um exemplo seria adicionar um termostato ao forno elétrico para desligá-lo quando a temperatura desejada for atingida.</p>
</li>
</ol>
<h2 id="controle-proporcional-p">Controle Proporcional (P)</h2>
<p>Um dos métodos mais simples e amplamente utilizados no controle em malha fechada é o controle proporcional. Este método ajusta a saída do controlador de forma proporcional à diferença (erro) entre o valor desejado (setpoint) e o valor medido da variável controlada. O coeficiente que determina a relação entre o erro e a ação de controle é conhecido como ganho proporcional (K_p). Portanto uma ação de controle proporcional é dada pela seguinte equação:</p>
<div class="highlight"><pre><span></span><code><span class="n">Ação</span> <span class="n">de</span> <span class="n">Controle</span> <span class="o">=</span> <span class="n">K_p</span> <span class="o">*</span> <span class="n">erro</span>
</code></pre></div>
<p>Na esqueção acima, podemos ver que a ação de controle é proporcional ao erro. Se o erro for grande, a ação de controle será grande. Se o erro for pequeno, a ação de controle será pequena. Portanto no exemplo do forno elétrico, ao ligar o forno frio, o erro será grande e a ação de controle será grande, aumentando a potência do forno e elevando a temperatura rapidamente. À medida que a temperatura se aproxima do setpoint, o erro diminui reduzindo a potência do forno, evitando que a temperatura ultrapasse o setpoint drasticamente.</p>
<h2 id="resposta-da-acao-de-controle">Resposta da Ação de Controle</h2>
<p>Outros conceitos importantes no controle são a resposta da ação de controle e o conceito de estabilidade. A resposta da ação de controle é a reação do sistema à ação de controle. Se a resposta for muito lenta, o sistema pode não atingir o setpoint ou pode crescer indefinidamente, levando o sistema a um estado instável. Se a resposta for muito rápida, o sistema pode ultrapassar o setpoint e oscilar em torno dele. Portanto, é importante ajustar o ganho proporcional para obter uma resposta rápida e estável.</p>
<h1 id="exemplo-de-controle-proporcional">Exemplo de Controle Proporcional</h1>
<p>A seguir, implementamos um exemplo simples de controle proporcional em Python. Neste exemplo, simulamos um sistema de controle de um drone que tenta manter a altitude constante para uma dada entrada de altitude, setpoint. Neste exemplo, você pode ajustar o ganho proporcional (K_p) e a resposta do sistema para visualizar como o controle proporcional afeta a resposta do sistema.</p>
<p>A figura abaixo ilustra o sistema:</p>
<p><img alt="Drone" src="../figs/drone.png" /></p>
<p>Durante seus experimentos, tente responder às seguintes perguntas:</p>
<ol>
<li>O que acontece se o ganho proporcional for muito baixo? E se for muito alto?</li>
<li>Qual a relação entre o ganho proporcional e a resposta do sistema para o momento em que o sistema nunca atinge o setpoint, ou seja, o sistema é instável?</li>
</ol>
<hr />
<p>layout: default
title: Simulação Drone PID</p>
<hr />
<h2 id="exemplo-controle-proporcional-de-altitude-drone">Exemplo Controle Proporcional de Altitude (Drone)</h2>
<p>Experimente ajustar o ganho proporcional <strong>Kp</strong> e o tempo de atualização do controlador para ver como o drone reage para atingir a altitude desejada.</p>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<div style="margin-top:1em; font-family:sans-serif; max-width:700px">
  <label for="kp"><b>Kp (Ganho):</b></label>
  <input type="range" id="kp" min="0" max="20" value="5" step="0.1" style="width:300px"
         oninput="document.getElementById('kp_val').textContent=this.value; updatePlot()">
  <span id="kp_val">5</span>
  <br><br>
  <label for="dt"><b>Tempo de Atualização (s):</b></label>
  <input type="range" id="dt" min="0.05" max="1.0" value="0.25" step="0.05" style="width:300px"
         oninput="document.getElementById('dt_val').textContent=this.value; updatePlot()">
  <span id="dt_val">0.25</span>
</div>

<div id="grafico" style="width:100%; max-width:700px; height:400px;"></div>

<script>
function simular(Kp, dt) {
  const setpoint = 10.0;
  const altitudeInicial = 0.0;
  const tempos = [];
  const altitudes = [];
  let altitude = altitudeInicial;
  for (let t = 0; t <= 10; t += dt) {
    tempos.push(t.toFixed(2));
    const erro = setpoint - altitude;
    const W = Kp * erro;
    altitude = altitude + W * dt;
    altitudes.push(altitude);
  }
  return {tempos, altitudes, setpoint};
}

function updatePlot() {
  const Kp = parseFloat(document.getElementById("kp").value);
  const dt = parseFloat(document.getElementById("dt").value);
  const {tempos, altitudes, setpoint} = simular(Kp, dt);

  const trace1 = {
    x: tempos, y: altitudes,
    mode: "lines", name: "Altitude do Drone",
    line: {color: "#0074D9", width: 3}
  };
  const trace2 = {
    x: tempos, y: Array(tempos.length).fill(setpoint),
    mode: "lines", name: "Altitude Alvo",
    line: {color: "red", dash: "dash"}
  };
  const layout = {
    title: `Simulação de Controle Proporcional (Kp=${Kp.toFixed(1)}, Δt=${dt.toFixed(2)}s)`,
    xaxis: {title: "Tempo (s)"},
    yaxis: {title: "Altitude (m)"},
    legend: {orientation: "h", y: -0.2},
    margin: {t:60, r:10, l:50, b:60}
  };
  Plotly.newPlot("grafico", [trace1, trace2], layout, {responsive:true});
}

updatePlot();
</script>



</section>
          
        
      </main>
      <footer class="ah-footer ah-typeset">
        <div class="ah-footer-nav">
          
          
        </div>
      </footer>
    </div>
    
      
    
  </body>
</html>